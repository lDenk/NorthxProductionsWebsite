@{
    ViewBag.Title = "Home Page";
}
@using northxproductions.Models;
@model NxVideo


<table align="center">

    <tr>
        <td>
            <video id="homepageVideoId" muted autoplay onplay="goToVideo()" onended="hideVideo()">
                <source src="~/Content/Videos/northxHomepage0218.mp4" />
            </video>
        </td>
        @*
    <td class="my-video-container">
        <iframe width="640" height="360"
                src="https://www.youtube.com/embed/lFdNUbgQpok"
                frameborder="0"
                allowfullscreen></iframe>
    </td>*@
        @*<td>
            @using (Html.BeginForm("GetPrev", "Home"))
            {
                <input type="hidden" name="Id" value="@Model.Id" />
                <input class="scrollArrowHome" id="prev" type="image" src="~/Content/Images/ArrowLeft.png" width="30" height="30"/>
            }
        </td>
        <td class="my-video-container">
            <iframe width="640" height="360"
                    src="@Model.Embed"
                    frameborder="0"
                    allowfullscreen></iframe>
        </td>
        <td>
            @using (Html.BeginForm("GetNext", "Home"))
            {
                <input type="hidden" name="Id" value="@Model.Id" />
                <input class="scrollArrowHome" id="next" type="image" src="~/Content/Images/ArrowRight.png" width="30" height="30"/>
            }
        </td>*@
    </tr>
</table>
    <div class="ldHorizontalScrollContainer">
        <div id="leftScroll"><</div>
        <div id="homeInstagram" class="ldHorizontalScrollViewContainer">
            <div class="homeInstagramObject">
                <div class="homeInstagramPicture">

                </div>
                <div class="homeInstagramText">

                </div>
            </div>
        </div>
        <div id="rightScroll">></div>
    </div>

    <div id="instagramPostContainer" class="instagramPostCenter">

    </div>



<script type="text/javascript">
    // https://stackoverflow.com/questions/27313480/scroll-div-content-horizontally-using-left-and-right-arrow-in-jquery

    @*Javascript for scrolling through instagram content*@
    // Variables and events for instagram slider
    var view = $("#homeInstagram");
    var move = "500px";
    var scrollLimit = -10000;
    var scrollPos = -175;
    view.scrollLeft(scrollPos);

    $("#rightScroll").click(function () {
        //var currentPosition = parseInt(view.css("left"));
        //if (currentPosition >= scrollLimit) view.stop(false, true).animate({ left: "-=" + move }, { duration: 400 });
        scrollPos += 500;
        view.scrollLeft(scrollPos);
    });

    $("#leftScroll").click(function () {
        //var currentPosition = parseInt(view.css("left"));
        //if (currentPosition < 0) view.stop(false, true).animate({ left: "+=" + move }, { duration: 400 });
        if (scrollPos > 0) {
            scrollPos -= 500;
            view.scrollLeft(scrollPos);
        }
    });

    @*Javascript for scrolling to video on homepage*@
    function timeOut() {
        setTimeout(null, 100);
    }
    function goToVideo() {
        var navBarHeight = 0;
        navBarHeight += document.getElementById('titleBar').offsetHeight;
        navBarHeight += document.getElementById('desktopMenu').offsetHeight;
        //$('body').animate({ scroll: navBarHeight }, 0);
        window.scrollTo(0, navBarHeight);
    }

    function hideVideo() {
        var video = document.getElementById('homepageVideoId');
        video.hidden = true;
        window.scrollTo(0, 0);
    }

    // Sets homepage video volume/size
    var video = document.getElementsByTagName('video')[0];
    var windowHeight = window.innerHeight - document.getElementById('desktopLogo').offsetHeight - 10;
    var windowWidth = window.innerWidth;
    video.height = windowHeight;
    video.volume = 0.5;

    // Gets instagram posts
    var mainDiv = document.getElementById('homeInstagram');
    var script = document.createElement('script');
    script.src = "https://api.instagram.com/v1/users/5639840073/media/recent?access_token=5639840073.4918e72.80bb2fd96e2b46c1b215eb86c4deba2c&callback=parseInstagram";
    mainDiv.appendChild(script);

    function parseInstagram(response) {
        // Summary: Callback for returned instagram data for us to parse through.
        // response: Object
        // See https://www.instagram.com/developer/endpoints/users/ GET /users/user-id/media/recent
        // for more information on the structure of the response.

        var container = document.getElementById('homeInstagram');
        var pictureClass;
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            pictureClass = "homeInstagramPictureMobile";
        }
        else {
            pictureClass = "homeInstagramPictue";
        }

        var instagramObject, instagramImg, instagramText, instagramContent;
        response.data.forEach(function (instagramMedia) {
            // Create container for one post
            instagramObject = this.initializeElement("div",
                {
                    "class": "ldHorizontalScrollObject",
                    "id": instagramMedia.link,
                }           
            );
            instagramObject.onclick = function () { getInstagramHtml(instagramMedia.link); };
            //instagramObject.click += 
            container.appendChild(instagramObject);

            // Create img element for picture
            instagramImg = this.initializeElement('img',
                {
                    "class": "homeInstagramPicture",
                    src: instagramMedia.link + "media",
                    frameborder: "0"                
                    //scrolling: "no"
                }
            );
            instagramObject.appendChild(instagramImg);

            // Create div for instagram test
            instagramText = this.initializeElement("div",
                {
                    "class": "homeInstagramText",
                    "title": instagramMedia.caption.text
                }
            );
            instagramObject.appendChild(instagramText);
            instagramText.innerText = instagramMedia.caption.text;
        }, this);

        // Hides horizontal scroll bar for instagram content
        var scrollContainer = document.getElementById('homeInstagram');
        var scrollBarHeight = scrollContainer.offsetHeight - scrollContainer.clientHeight;
        scrollBarHeight = scrollBarHeight * -1;
        //scrollContainer.style.paddingBottom = scrollBarHeight + "px";
    }

    /** Used when instagram post is clicked in horizontal scroll on homepage. **
    ** 'postUrl' is the id of object clicked, which was set to the instagram url for that post **/
    function getInstagramHtml(postUrl) {
        //var body = document.getElementById('bodyContent');
        var instagramPost, frame, frameHeight;

        //instagramPost = $("#instagramPostContainer");
        instagramPost = document.getElementById('instagramPostContainer');

        /** Removes old instagram post from div **/
        while (instagramPost.firstChild) {
            instagramPost.removeChild(instagramPost.firstChild);
        }

        frame = this.initializeElement("iframe",
        {
            src: postUrl + "embed",         
            "class": "instagramFrame",
            "id": "instagramFrameId",
            scrolling: "no"
        });
        instagramPost.appendChild(frame);        
        /*Gets json for embedding whole instagram post without creating iframe of whole post page*/
        /*$.getJSON('https://api.instagram.com/oembed/?url=' + postUrl, function(data) {
            instagramPost.html(data.html);
            //instagramPost = this.initializeElement("div", data.html);
        });*/

    }

    function initializeElement(elementTag, attributes) {
        // elementTag: String, type of element to create
        // attributes: Object, object with attribute name and value pairs to initialize the element with

        var element = document.createElement(elementTag);

        for (var attribute in attributes) {
            element.setAttribute(attribute.toString(), attributes[attribute]);
        }

        return element;
    }
</script>

<script>
   
</script>